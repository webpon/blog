- [?. React??](#?-react??)
  - [1.React?????](#1react?????)
  - [2.React???MVC???](#2react???mvc???)
  - [3.React???](#3react???)
  - [??DOM](#??dom)
- [?. create-react-app](#?-create-react-app)
- [???????react????](#??????react????)
- [?. JSX?????](#?-jsx?????)
  - [1.JSX??](#1jsx??)
  - [2.Class??](#2class??)
  - [3.?????](#3?????)
  - [4.?????](#4?????)
  - [**5.????**](#5????)
  - [6.Ref???](#6ref???)
- [???????????](#??????????)
  - [1???(state)](#1??state)
  - [2???(props)](#2??props)
  - [**3???vs??**](#3??vs??)
  - [4?????](#4????)
- [????????????????](#???????????????)
  - [1??????](#1?????)
  - [2?????](#2????)
- [**?**.???????](#????????)
  - [**1.** **????????**](#1-????????)
  - [2. ?????????](#2-?????????)
- [**?. React????**](#?-react????)
- [**?**. React Hooks](#?-react-hooks)
  - [**useState(**??????)](#usestate??????)
  - [**useEffffect(**?????)?useLayoutEffffect (????????](#useeffffect??????uselayouteffffect-???????)
  - [**useCallback(????)**](#usecallback????)
  - [**useMemo????**](#usememo????)
  - [**useRef(?????)**](#useref?????)
  - [**useReducer?useContext(??????)**](#usereducer?usecontext??????)
  - [**???hooks**](#???hooks)
- [?. React??](#?-react??)
  - [1.??????](#1?????)
  - [2.????](#2????)
  - [3.????](#3????)
- [??. Flux?Redux](#??-flux?redux)
- [??. react-redux](#??-react-redux)
- [??. UI???](#??-ui???)
- [??. Immutable](#??-immutable)
- [??. Mobx](#??-mobx)
- [??. TS](#??-ts)
  - [**1-typescript**](#1-typescript)
  - [**2-??**](#2-??)
  - [**3-??**](#3-??)
  - [4-????](#4-????)
  - [5-??????](#5-??????)
  - [6-?????](#6-?????)
  - [8-???????](#8-???????)
  - [9-????](#9-????)
  - [10-??](#10-??)
  - [**11-redux**](#11-redux)
- [??. styled-components](#??-styled-components)
- [??.????](#??????)
- [??. redux-saga](#??-redux-saga)
- [??. React??](#??-react??)
  - [**1. Portal**](#1-portal)
  - [**2.Lazy** **?** **Suspense**](#2lazy-?-suspense)
  - [**3. forwordRef**](#3-forwordref)
  - [4. Functional Component??](#4-functional-component??)
#### ?. React??

##### 1.React?????

> React ??? Facebook ????????????????? JavaScript MVC ?????????????????????Instagram ??????????????????????2013?5?????

##### 2.React???MVC???

> ???????**?**?*A JavaScript library for building user interfaces*
>
> React???????MVC??????????MVC??V?View????React??????MVC?????React ???? UI ????????????React ??????????????????????????????????????????????

##### 3.React???

![image-20221023132201570](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023132201570.png)

##### ??DOM

![image-20221023135105312](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023135105312.png)

![image-20221023135158701](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023135158701.png)

#### ?. create-react-app

????create-react-app

>  npm install -g create-react-app

??????

>  create-react-app your-app

???????????????npx

> npx create-react-app myapp

????????????????????????

- react: react????
- react-dom: ??react???????????app??react-native, ????web??????react-dom
- react-scripts: ???????react????????????

?????????? cd your-app ????????? npm start ???????

????????????

> ??? README.md ???????
>
> ??? node_modules ??????????
>
> ??? package-lock.json ???????????,?????????????
>
> ??? package.json
>
> ??? public ??????
>
> ??? src ?????????

#### ???????react????

react?????????????react.js?react-dom.js???????????????create-react-app?????????????????

```js
// ? react ??????? React?????? React.js ???????React, ??react???????JSX??????JSX???JSX??????React
import React from 'react'
// ReactDOM ??????? React ?????????????????????? react-dom ????????? react ???
import ReactDOM from 'react-dom'
// ReactDOM????render???????????????? DOM ??????????????????
ReactDOM.render(
// ????????????????????????? HTML ???? JavaScript ?????????????????? JavaScript ??, ?? //JavaScript ????????? JSXJavaScript XML?
<h1>????React???</h1>,
// ?????
	document.getElementById('root')
)
```

> ???
>
> <React.StrictMode> ??????
>
> ??????????
>
> ????????? ref API ???
>
> ????????
>
> ????? context API

#### ?. JSX?????

##### 1.JSX??

> JSX ? HTML ??????? JavaScript ?????????????? JavaScript ????????
>
> ???????JSX ?????????????? JavaScript??????????????????????????? ?????Babel ? JSX ??????

https://reactjs.org/docs/hello-world.html

**???????**

???JSX???????????? JavaScript ??????? DOM ??????

????DOM??

```
<div class='app' id='appRoot'>
	<h1 class='title'>????React???</h1>
	<p>
		React.js ?????????? UI ??
	</p>
</div>
```

???? HTML ??????????? JavaScript ??????

```js
{
    tag: 'div',
    attrs: { className: 'app', id: 'appRoot'},
    children: [
        {
            tag: 'h1',
            attrs: { className: 'title' },
            children: ['????React???']
        },
        {
            tag: 'p',
            attrs: null,
            children: ['React.js ??????? UI ??']
        }
	]
}
```

??? JavaScript ?????????????????? HTML ?????????????

?? React.js ?? JavaScript ?????????? JavaScript ??????????? JavaScript ???????? HTML ????????????????????????????? HTML ? JSX????? JavaScript ?????

**????:**

```js
import React from 'react'
import ReactDOM from 'react-dom'
class App extends React.Component {
    render() {
        return (
            <div className='app' id='appRoot'>
                <h1 className='title'>????React???</h1>
                <p>
                    React.js ??????? UI ??
                </p>
            </div>
        )
    }
}
ReactDOM.render(
    <App />,
    document.getElementById('root')
)
```

????????????:

```js
import React from 'react'
import ReactDOM from 'react-dom'
class App extends React.Component {
    render() {
        return (
            React.createElement(
                "div",
                {
                    className: 'app',
                    id: 'appRoot'
                },
                React.createElement(
                    "h1",
                    { className: 'title' },
                    "????React???"
                ),
                React.createElement(
                    "p",
                    null,
                    "React.js ??????? UI ??"
                )
            )
        )
    }
}
ReactDOM.render(
    React.createElement(App),
    document.getElementById('root')
)
```

React.createElement ????? JavaScript ?????? HTML ?????????????????????, ???

```js
React.createElement(
    type,
    [props],
    [...children]
)
```

??? JSX ???? JavaScript ??????? React ? JSX ?????????????:

```
JSX ???react?????bable?????> JavaScript?? ? ReactDOM.render() ?>DOM
?? ?>????
```

##### 2.Class??

ES6????JavaScript??????class???????react?????????????????ES6 class ?????????????????ES6??????????????

```js
import React from 'react'
import ReactDOM from 'react-dom'
class App extends React.Component {
    render() {
        return (
            <h1>????React???</h1>
        )
    }
}
ReactDOM.render(
    <App />,
    document.getElementById('root')
)
```

**es6 class ??**?????????,?????????????????????

```js
import React from 'react'
import ReactDOM from 'react-dom'
class App extends React.Component {
    render() {
        return (
            <h1>????{this.props.name}???</h1>
        )
    }
}
const app = new App({
    name: 'react'
}).render()
ReactDOM.render(
    app,
    document.getElementById('root')
)
```

##### 3.?????

```js
import React from 'react'
import ReactDOM from 'react-dom'
const App = (props) => <h1>????React???</h1>
ReactDOM.render(
    // React???????
    <App />,
    document.getElementById('root')
)
```

`????????????????????**?????????**?????**??**??????`

#####  4.?????

- ????

????dom???????????????????????????

```js
// ???????????????????JSX???JS???????????
<p style={{color:'red', fontSize:'14px'}}>Hello world</p>
```

???????????????????????????????????? render ?????

???????js???

- ?? class

React?????????????React????????????????

????????????????????????????????? class ????

className ?????????js??????js??????? class ?????

```html
<p className="hello">Hello world</p>
```

```
???
class ==> className , for ==> htmlFor(label)
```

##### **5.????**

**5.1?????**

??on+????????????????????????????????????????

onclick , React??????? onClick ?**React?????????????????**?

**5.2???handler???**

- ???render?????????(???)

- ????????????????(??)

- ??????????????????????render????? onClick=

		{this.handleClick.bind(this)} (???)

- ??????????????????????constructor?bind(this)(??)

**5.3?Even??**

???????????handler???????? event ?????????????? event ????????????????????? React?? event ????????????????????????????? event.stopPropagation ? event.preventDefault ???????

##### 6.Ref???

**6.1?????ref="username**

 ??????this.refs.username , ref??????????dom

**6.2** **?????**ref="username"

 ??????this.refs.username ,ref?????????

**6.3** **????**

```
myRef = React.createRef()
<div ref={this.myRef}>hello</div>
??this.myRef.current
```

#### ???????????

##### 1???(state)

> ???????????????????????????????????????????????????????????????????(????)

**(1)** ??state

?????

```js
import React, { Component } from 'react'
import ReactDOM from 'react-dom'
class App extends Component {
    state = {
        name: 'React',
        isLiked: false
    }
    render() {
        return (
            <div>
                <h1>????{this.state.name}???</h1>
                <button>
                    {
                        this.state.isLiked ? '???' : '????'
                    }
                </button>
            </div>
        )
    }
}
ReactDOM.render(
    <App />,
    document.getElementById('root')
)
```

?????

```js
import React, { Component } from 'react'
import ReactDOM from 'react-dom'
class App extends Component {
    constructor() {
        super()
        this.state = {
            name: 'React',
            isLiked: false
        }
    }
    render() {
        return (
            <div>
                <h1>????{this.state.name}???</h1>
                <button>
                    {
                        this.state.isLiked ? '???' : '????'
                    }
                </button>
            </div>
        )
    }
}
ReactDOM.render(
    <App />,
    document.getElementById('root')
)
```

this.state ??js??,?vue??data????? Object.defineProperty ???????data?

??????????? getter ? setter ???React???????????????????

react???????????????????????? setState ?

**(2) setState**

isLiked ?????? state ???????? render ?????????? state ???

isLiked ??????????????????? button ???????????

```js
import React, { Component } from 'react'
import ReactDOM from 'react-dom'
class App extends Component {
    constructor() {
        super()
        this.state = {
            name: 'React',
            isLiked: false
        }
    }
    handleBtnClick = () => {
        this.setState({
            isLiked: !this.state.isLiked
        })
    }
    render() {
        return (
            <div>
                <h1>????{this.state.name}???</h1>
                <button onClick={this.handleBtnClick}>
                    {
                        this.state.isLiked ? '???' : '????'
                    }
                </button>
            </div>
        )
    }
}
ReactDOM.render(
    <App />,
    document.getElementById('root')
)
```

setState ?????

?????????????????return?????????????? updater

- ?????

```
this.setState({
	isLiked: !this.state.isLiked
})
```

- ?????

```js
this.setState((prevState, props) => {
    return {
    isLiked: !prevState.isLiked
    }
})
```

???????????????????????state, ????props

setState ???????????????state????????????????????????????

```js
this.setState((prevState, props) => {
    return {
        isLiked: !prevState.isLiked
    }
}, () => {
    console.log('????', this.state.isLiked)
})
console.log('setState???', this.state.isLiked)
```

##### 2???(props)

props ??????????????????????????????????????????????????????????????????? props????????????????????????????????? props ???????????????????????????????????????????????? props ?????????????????????????????? props :

`(1) ??????key=value ???,??this.props????,?????????????`

`(2) ?????????????isShow="true" ????????? ????isShow={true} ??????`

`(3) {...??} ????`

`(4) ?????`

```
*.defaultProps = {
}
    static defaultProps = {
    myname:"???myname",
    myshow:true
}
```

(5) prop-types ????

```js
import propTypes from "prop-types";
??.propTypes={
    name:propTypes.string,
    age:propTypes.number
}
??
static propTypes={
    myname:propTypes.string,
    myshow:propTypes.bool
}
```

##### **3???vs??**

???????js???????render????????????/??????????

????

1. ??????????????

2. ???????????????

3. ?????????????????????????

4. ?????????????????????

5. ?????????????????

6. ?????????????????

`state ?????????????????????????? state ????????????`

`????????????????????????? state ????????????????????? state ??????? this.setState ??????? setState ?????????`

`??`

`props ????????????????????????????????????????`

`???????????????????????????? props ?????? props ???????`

`?? state ??????????stateless component????? state ????????`

`?stateful component????????????????????????????????????????????????????????????????????????`

##### 4?????

- ????

  ```
  {
  	condition ? '???????' : '????'
  }
  ```

- ????

  ```js
  // ??
  const people = [{
      id: 1,
      name: 'Leo',
      age: 35
  }, {
      id: 2,
      name: 'XiaoMing',
      age: 16
  }]
  // ????
  {
      people.map(person => {
          return (
              <dl key={person.id}>
                  <dt>{person.name}</dt>
                  <dd>age: {person.age}</dd>
              </dl>
          )
      })
  }
  ```

  React????????? Virtual-DOM????? DOM??????????????????????????????????????????????? DOM ????????React????????????????????????????????????? Virtual-DOM ????????? DOM ???????????????????React ???????????????????????? key ??? key ????????????

- dangerouslySetInnerHTML

  ???????????????????????

  ```
  content = "<p>React.js?????UI??</p>"
  ```

  ????????React??????????????????????????????????????? dangerouslySetHTML ???????????? innerHTML

  ```js
  import React, { Component } from 'react'
  import ReactDOM from 'react-dom'
  class App extends Component {
      constructor() {
          super()
          this.state = {
              content: "<p>React.js?????UI??</p>"
          }
      }
      render() {
          return (
              <div
                  // ??????????? __html
                  dangerouslySetInnerHTML={{ __html: this.state.content }}
              />
          )
      }
  }
  ReactDOM.render(
      <App />,
      document.getElementById('root')
  )
  ```

#### ????????????????

##### 1??????

React????????????? ?? ref ?? DOM ??????????????????

????????????????????????

```js
class NameForm extends React.Component {
    constructor(props) {
        super(props);
        this.handleSubmit = this.handleSubmit.bind(this);
        this.input = React.createRef();
    }
    handleSubmit(event) {
        alert('A name was submitted: ' + this.input.current.value);
        event.preventDefault();
    }
    render() {
        return (
            <form onSubmit={this.handleSubmit}>
                <label>
                    Name:
                    <input type="text" ref={this.input} />
                </label>
                <input type="submit" value="Submit" />
            </form>
        );
    }
}
```

??????????????? DOM ???????????????????????????? React ?? React ??????????????????????????????????????????????????????????

**???**

? React ?????????????? value ???? DOM ??????????????????? React ??????????????????????? ??????, ???????defaultValue ?????? value ?

```js
render() {
    return (
        <form onSubmit={this.handleSubmit}>
            <label>
                Name:
                <input
                    defaultValue="Bob"
                    type="text"
                    ref={this.input} />
            </label>
            <input type="submit" value="Submit" />
        </form>
    );
}
```

??? <input type="checkbox"> ? <input type="radio"> ?? defaultChecked ? <select>? <textarea> ?? defaultValue ?

##### 2?????

```jsx
class NameForm extends React.Component {
    constructor(props) {
        super(props);
        this.state = { value: '' };
        this.handleChange = this.handleChange.bind(this);
        this.handleSubmit = this.handleSubmit.bind(this);
    }
    handleChange(event) {
        this.setState({ value: event.target.value });
    }
    handleSubmit(event) {
        alert('?????: ' + this.state.value);
        event.preventDefault();
    }
    render() {
        return (
            <form onSubmit={this.handleSubmit}>
                <label>
                    ??:
                    <input type="text" value={this.state.value} onChange={this.handleChange} />
                </label>
                <input type="submit" value="??" />
            </form>);
    }
}
```

??????????? value ????????????? this.state.value ???? React ? state ?????????? handlechange ????????????? React ? state??????????????????

???????????????? React ? state ???????? value ????? UI ??????????????????????????????????

> ??: ???????????????React???????????????? props ??????????????????????

#### **?**.???????

##### **1.** **????????**

(1) ????(???)?????(???)

(2) ref?? (??????????????????????)

???????????input????value??**this.refs.form.reset()** 

##### 2. ?????????

**(1)** **????**(?????)

**(2)** **????????**

**(3) context**?????

```js
a. ?????context??
import React from 'react'
const GlobalContext = React.createContext()
export default GlobalContext
```

```js
b. ?????GlobalContext????GlobalContext.Provider?????
//??????? class App {}
<GlobalContext.Provider
    value={{
    name:"kerwin",
    age:100,
    content:this.state.content,
    show:this.show.bind(this),
    hide:this.hide.bind(this)
    }}
>
<??????></??????>
</GlobalContext.Provider>
```

???GlobalContext.Consumer???????????context?????????

> context????
>
> ??????????
>
> ???react??????????shouldComponetUpdate ??false,?context?????
>
> ?????????

#### **?. React????**

**1.** **?????**

![image-20221023180504551](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023180504551.png)

**2.** **?????**

![image-20221023180625011](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023180625011.png)

**3.** **????**

![image-20221023180700328](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023180700328.png)

**????????**

(1) componentWillMount ,?ssr? ???????????? ?????????????????????????????????? ? ?????????????

(2) componentWillReceiveProps ????????????????? props????????????

(3) componetWillupdate, ????? DOM ??, ??????????componentDidUpdate????????? ??? ?????

**????????**

?1?getDerivedStateFromProps ???????????????????(?????????????) ???????????state???null???????????state

```js
//?????????
componentDidMount() {
    if (this.props.value !== undefined) {
        this.setState({
            current: this.props.value
        })
    }
}
componentWillReceiveProps(nextProps){
    if (nextProps.value !== undefined) {
        this.setState({
            current: nextProps.value
        })
    }
}
// ????????
static getDerivedStateFromProps(nextProps) {
    if (nextProps.value !== undefined) {
        return {
            current: nextProps.value
        }
    }
    return null
}
```

 (2) getSnapshotBeforeUpdate ??? componetWillUpdate ,?????update???????**render**??dom????????????componentDidUpdate???????

```jsx
//????????????? ????????????????????????????????
getSnapshotBeforeUpdate(){
    return this.refs.wrapper.scrollHeight
}
componentDidUpdate(prevProps, prevState, preHeight) {//if(preHeight===200)return ;
    this.refs.wrapper.scrollTop += this.refs.wrapper.scrollHeight - preHeight
}
<div style={{ height: "200px", overflow: "auto" }}} ref="wrapper">
    <ul>
        .........
    </ul>
</div>
```

**react****????????**

**1. shouldComponentUpdate**

???????????????????????????????? ???????

**2. PureComponent**

PureComponent??? ???props ? ??props? ??state???state????,??

???????????????? ????shouldcomponentUpdate ??true ??

false? ????????? render function?

???

???? state ? props ????????? PureComponent ?????????

 shallowEqual ???????

#### **?**. React Hooks

??hooks??

1. ?????????????????

2. ???????

3. ??functional??,????? ????????????class,???

##### **useState(**??????)

```
const [state, setstate] = useState(initialState)
```

##### **useEffffect(**?????)?useLayoutEffffect (????????

*Function Component* ????????????? *Class Component* ?????????????????

```js
useEffect(() => {
    //effect
    return () => {
    //cleanup
    };
}, [?????;???,?????])
```

**??? Dependencies ??, ??????????????????????????? React ???????????????????useEffffect ???????, eslint????**

*Preview*????????????????*id=1*???*id=2*??????????*class*????

```js
let id = props.match.params.myid
useEffect(() => {
    axios.get(`/articles/${id}`).then(res => {
        settitle(res.data.title)
        setcontent(res.data.content)
        setcategory(res.data.category)
    })
}, [id])
```

`useEffect?useLayoutEffect??????`

**????????????? useLayoutEffect ??? componentDidMount & componentDidUpdate ????react??DOM??????????????????????useEffect ??????????????????**

???????? useEffect

> However, **we recommend starting with useEffffect fifirst** and only trying useLayoutEffffect if that causesa problem.

???????????**????**?? useEffect ???DOM?????????????????DOM????? useLayoutEffect ???????dom?????dom???? react ???????????????????????????????

##### **useCallback(????)**

???????????????????? ???????*;* ??????? ???????????

```js
var handleClick = useCallback(()=>{
	console.log(name)
},[name])
<button onClick={()=>handleClick()}>hello</button>
//??name???? ?????????????
//???????? ??????????????? ??name?????,???????name?
//?????????????????????????????name.
```

##### **useMemo????**

useCallback ???????? useMemo ???????????? useMemo ????????????????

```
useCallback(fn, inputs) is equivalent to useMemo(() => fn, inputs).
```

???????**useCallback** **??????????????????????** **useMemo** ???????????????????????????????????? handleClick ???????????

?? useCallback ?????????????????????????????? useMemo ?????????????????????????

##### **useRef(?????)**

```jsx
const myswiper = useRef(null);
<Swiper ref={myswiper}/>
```

##### **useReducer?useContext(??????)**

```jsx
import React from 'react'
var GlobalContext = React.createContext()
// ?????reduecer ???????? {isShow:false,list:[]}
function App(props) {
    let [state, dispatch] = useReducer(reducer, { isShow: true, list: [] })
    return <GlobalContext.Provider value={{
        dispatch
    }}>
        <div>
            {
                state.isShow ?
                    <div >?????</div>
                    : null
            }
            {props.children}
        </div>
    </GlobalContext.Provider>
}
function Detail() {
    var { dispatch } = useContext(GlobalContext)
    useEffect(() => {
        //??
        dispatch({
            type: "Hide",
            payload: false
        })
        return () => {
            //??
            dispatch({
                type: "Show",
                payload: true
            })
        };
    }, [])
    return <div>
        detail
    </div>
}
```

##### **???hooks**

**???????????????????????????????**

????use??????????????????????????????????????????? Hook????React ????????? Hook ????? Hook ???

#### ?. React??

##### 1.??????

> ???????? url ?????????????
>
> ????React????????????????????React components ?URl?????????

##### 2.????

https://reacttraining.com/react-router/web/guides/quick-start

```
npm install react-router-dom@5
```

##### 3.????

**(1)** ??????

```
import React from "react";
import {
    BrowserRouter as Router,
    Switch,
    Route,
    Link
} from "react-router-dom";
```

**(2)** **?????????**

```jsx
HashRouter>
    <Switch>
        <Route path="/films" component={Films}/>
        <Route path="/cinemas" component={Cinemas}/>
        <Route path="/center" component={Center}/>
        <Redirect from="/" to="/films" />
        {
        	/* <Redirect from="/" to="/films" exact/><Route path="*" component={NotFound}/> */
    	}
    </Switch>
</HashRouter>
```

??? a. 

 b. exact ???? (Redirect ?????exact, ??????Switch ??)

 c. Warning: Hash history cannot PUSH the same path; a new entry will not be added to the history

stack,???????hash ??????

**(3)** **????**

```jsx
<Switch>
    <Route path="/films/nowplaying" component={Nowplaying}/>
    <Route path="/films/comingsoon" component={Comingsoon}/>
    <Redirect from="/films" to="/films/nowplaying"/>
</Switch>
```

**(4)** **??????**

a. ?????

```jsx
<NavLink to="/films" activeClassName="active">films</NavLink>
<NavLink to="/cinemas" activeClassName="active">cinemas</NavLink>
<NavLink to="/center" activeClassName="active">center</NavLink>
```

b. ?????

```js
this.props.history.push(`/center`)
```

**(5)** **????**

```js
(1)
this.props.history.push({ pathname : '/user' ,query : { day: 'Friday'} })
this.props.location.query.day
(2)
this.props.history.push({ pathname:'/user',state:{day : 'Friday' } })
this.props.location.state.day
```

**(6)** **????**

```js
<Route path="/center" render={()=>isAuth()?<Center/>:<Login/>}/>
```

**(7) withRouter??????**

![image-20221023201040680](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023201040680.png)

```js
import { withRouter } from "react-router";
withRouter(MyComponent);
withRouter(connect(...)(MyComponent))
```

4.????

**(1)** **????**

https://facebook.github.io/create-react-app/docs/proxying-api-requests-in-development

```
npm install http-proxy-middleware --save
```

```js
const { createProxyMiddleware } = require('http-proxy-middleware');
module.exports = function (app) {
    app.use(
        '/api',
        createProxyMiddleware({
            target: 'http://localhost:5000',
            changeOrigin: true,
        })
    );
};
```

**(2) css module**

https://facebook.github.io/create-react-app/docs/adding-a-css-modules-stylesheet

```
??
:global(.active){
}
```

#### ??. Flux?Redux

Flux ??????????????????????MVC????????????????

???Flux??????(??15?)

> https://github.com/voronianski/flflux-comparison
>
> Facebook Flux????????Web???????????**?????**??????React
>
> ?????????????????????????????????????????
>
> ????Flux?

![image-20221023202237520](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023202237520.png)

Redux??????????????????Redux????????????state??????????????????????????????????????????????????actions?reducers?????????????????????

1. **redux?????????????**

   ![image-20221023202404606](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023202404606.png)

	**2.redux???**

![image-20221023202512655](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023202512655.png)

**3.** **?react?????redux????**

![image-20221023202600830](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023202600830.png)

![image-20221023202614959](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023202614959.png)

4.  **reducer??**

???????action?????????????????? Reducer ??????????

????????????????????? Reducer ???

```
import {combineReducers} from "redux";
const reducer = combineReducers({
    a: functionA,
    b: functionB,
    c: functionC
})
???
(state)=>{
    return {
    	kerwinstate:state.a (???????)
    }
}
```

5**.redux???**

?redux??action???????????js???action creator???????action???

???????store.dispatch()????????????????????reducer?????

?????

????????action?reducer?????????????????middleware?

**i.** **????????????**

```js
export default function thunkMiddleware({ dispatch, getState }) {
    return next => action =>
        typeof action === 'function' ?
            action(dispatch, getState) :
            next(action);
}
```

??????????????????????action?????function?????????

?next??(?????)????????????????action?function?????action?

action??????????action?????dispatch?

**ii.** **????????**

a. redux-thunk (store.dispatch???????function)

```js
import thunk from 'redux-thunk';
import { applyMiddleware } from "redux";
const store = createStore(fetchReducer, applyMiddleware(thunk));
const getComingSoon = () => {
    //??????
    return (dispatch, store) => {
    }
}
```

b. redux-promise (store.dispatch???????promise??)

```js
import promiseMiddleware from 'redux-promise';
const store = createStore(fetchReducer, applyMiddleware(thunk, promiseMiddleware));
const getComingSoon = () => {
    //??????
    return axios.get(`****`).then(res => {
        return {
            type: "cominglist",
            info: res.data.data
        }
    })
}
```

**7. Redux DevTools Extension**

https://github.com/zalmoxisus/redux-devtools-extension

```js
import { createStore, compose} from 'redux'
import reducer from './reducer'
const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;
const store = createStore(reducer, /* preloadedState, */ composeEnhancers())
export default store
```

#### ??. react-redux

**1.** **??**

![image-20221023204943480](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023204943480.png)

https://github.com/reactjs/react-redux

**2.** **?????UI??**

?1?UI??

???? UI ?????????????

??????????this.state?????

??????????this.props???

?????? Redux ? API

 (2) ????

???????????????? UI ???

???????

??? Redux ? API

3. **Provider?connect**

?1?React-Redux ??Provider????????????state?

```jsx
import React from 'react'
import ReactDOM from 'react-dom'
import { Provider } from 'react-redux'
import store from './store'
import App from './App'
const rootElement = document.getElementById('root')
ReactDOM.render(
    <Provider store={store}>
    	<App />
    </Provider>,
    rootElement
)
```

?2?React-Redux ??connect?????? UI ?????????connect????????

 ???????.

```jsx
import { connect } from 'react-redux'
import { increment, decrement, reset } from './actionCreators'
// const Counter = ...
const mapStateToProps = (state /*, ownProps*/) => {
    return {
    	counter: state.counter
    }
}
const mapDispatchToProps = { increment, decrement, reset }
export default connect(
	mapStateToProps,
	mapDispatchToProps
)(Counter)
```

4. **HOC?context???react-redux??????**

(1) connect ?HOC? ????

(2) Provider????????????state ? ???context

**5.** **?????????**

HOC????????????????????????????????????

(1)??????????

(2)???props

(3) ????

```jsx
// Child.js
//????
function Control(wrappedComponent) {
    return class MyControl extends React.Component {
        render() {
            if (!this.props.data) {
                return <div>loading...</div>
            }
            return <wrappedComponent {...props} />
        }
    }
}
class MyComponent extends React.Component {
    render() {
        return <div>{this.props.data}</div>
    }
}
export default Control(MyComponent); //????
//Parent.js
import MyControlComponent from "./Child"
<MyControlComponent data={this.state.value} />
    //?????data?null?????????????loading...,
    //??????????????data??null, ??????????
```

**6. Redux** **???**

```jsx
import { persistStore, persistReducer } from 'redux-persist';
import storage from 'redux-persist/lib/storage';
import autoMergeLevel2 from 'redux-persist/lib/stateReconciler/autoMergeLevel2';
const persistConfig = {
    key: 'kerwin',
    storage: storage,
    //localStorage: import storage from 'redux-persist/lib/storage'
    //sessionStorage: import storageSession from 'redux-persist/lib/storage/session'
    stateReconciler: autoMergeLevel2
    //??????????????????????????
};
//??reducer
const myPersistReducer = persistReducer(persistConfig, reducer)
//??store
export const persistor = persistStore(store)
//?????
import { persistor } from './Store'
import { PersistGate } from 'redux-persist/lib/integration/react';
<PersistGate loading={null} persistor={persistor}>
    ...
</PersistGate>
```

#### ??. UI???

#### ??. Immutable

```js
var obj = { /* ????????? */ };
doSomething(obj);
// ????????????? obj ??????? obj ??
// deepCopy?
```

**1.Immutable.js??**

https://github.com/immutable-js/immutable-js

?????? Immutable ??????????????????????????????????????????????????????

**2.** **??????????**

(1) var arr = { } ; arr2 = arr ;

(2) Object.assign() ??????????????????????

(3) const obj1 = JSON.parse(JSON.stringify(obj)); ???????????(??: ???undefifined)

**3.Immutable???????**

Immutable ?????? Persistent Data Structure????????????????????????????????????????????? deepCopy ??????????????????Immutable ??? Structural Sharing??????????????????????????????????????????????????

 https://upload-images.jianshu.io/upload_images/2165169-cebb05bca02f1772

**4.Immutable??????Map?List?**

?1?Map

```js
const { Map } = require('immutable');
const map1 = Map({ a: 1, b: 2, c: 3 });
const map2 = map1.set('b', 50);
map1.get('b') + " vs. " + map2.get('b'); // 2 vs. 50
```

![image-20221023221621850](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023221621850.png)

 (2) List

```
const { List } = require('immutable');
const list1 = List([ 1, 2 ]);
const list2 = list1.push(3, 4, 5);
const list3 = list2.unshift(0);
const list4 = list1.concat(list2, list3);
assert.equal(list1.size, 2);
assert.equal(list2.size, 5);
assert.equal(list3.size, 6);
assert.equal(list4.size, 13);
assert.equal(list4.get(0), 1);
//push, set, unshift or splice ?????????????immutable??
```

(3) merge , concat

```
const { Map, List } = require('immutable');
const map1 = Map({ a: 1, b: 2, c: 3, d: 4 });
const map2 = Map({ c: 10, a: 20, t: 30 });
const obj = { d: 100, o: 200, g: 300 };
const map3 = map1.merge(map2, obj);
// Map { a: 20, b: 2, c: 10, d: 100, t: 30, o: 200, g: 300 }
const list1 = List([ 1, 2, 3 ]);
const list2 = List([ 4, 5, 6 ]);
const array = [ 7, 8, 9 ];
const list3 = list1.concat(list2, array);
// List [ 1, 2, 3, 4, 5, 6, 7, 8, 9 ]
```

(4) toJS

```js
const { Map, List } = require('immutable');
const deep = Map({ a: 1, b: 2, c: List([ 3, 4, 5 ]) });
console.log(deep.toObject()); // { a: 1, b: 2, c: List [ 3, 4, 5 ] }
console.log(deep.toArray()); // [ 1, 2, List [ 3, 4, 5 ] ]
console.log(deep.toJS()); // { a: 1, b: 2, c: [ 3, 4, 5 ] }
JSON.stringify(deep); // '{"a":1,"b":2,"c":[3,4,5]}'
```

(5)fromJS

```
const { fromJS } = require('immutable');
const nested = fromJS({ a: { b: { c: [ 3, 4, 5 ] } } });
// Map { a: Map { b: Map { c: List [ 3, 4, 5 ] } } }
const nested2 = nested.mergeDeep({ a: { b: { d: 6 } } });
// Map { a: Map { b: Map { c: List [ 3, 4, 5 ], d: 6 } } }
console.log(nested2.getIn([ 'a', 'b', 'd' ])); // 6
//??????? ????get?????????? getIn(["a","b","c"]])
//setIn ?????
const nested3 = nested2.setIn([ 'a', 'b', 'd' ], "kerwin");
// Map { a: Map { b: Map { c: List [ 3, 4, 5 ], d: "kerwin" } } }
//updateIn ??????
const nested3 = nested2.updateIn([ 'a', 'b', 'd' ], value => value + 1);
console.log(nested3);
// Map { a: Map { b: Map { c: List [ 3, 4, 5 ], d: 7 } } }
const nested4 = nested3.updateIn([ 'a', 'b', 'c' ], list => list.push(6));
// Map { a: Map { b: Map { c: List [ 3, 4, 5, 6 ], d: 7 } } }
```

5. Immutable+Redux?????

   ```js
   //reducer.js
   const initialState = fromJS({
       category: "",
       material: ""
   })
   const reducer = (prevstate = initialState, action = {}) => {
       let { type, payload } = action
       switch (type) {
           case GET_HOME:
               var newstate = prevstate.set("category", fromJS(payload.category))
               var newstate2 = newstate.set("material", fromJS(payload.material))
               return newstate2;
           default:
               return prevstate
       }
   }
   //home.js
   const mapStateToProps = (state) => {
       return {
           category: state.homeReducer.getIn(["category"]) || Map({}),
           material: state.homeReducer.getIn(["material"]) || Map({})
       }
   }
   this.props.category.get("????")
   this.props.category.toJS() //????????
   ```

   **6.** **??**

   ???????

   ????????

#### ??. Mobx

https://cn.mobx.js.org/

1. **Mobx??**

(1) Mobx??????????????????????

(2) Mobx????????: ????????????????????

(3) Mobx??getter?setter????????????????????????

??????????????????????????????????????

?vue???

![image-20221023231251639](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023231251639.png)

2. **Mobx?redux???**

Mobx???????OOP

???????????????????????????

????store,???store?

Redux???JavaScript????????????Mobx???????

???

**a. ?????**

**b. ??????, ??? TS ??**

???

**a. ?????Mobx????????????????????????????**

**??????????????????**

**b. ???????????????????**

3. **Mobx???**

?1?observable ? **autorun**

```js
import { observable, autorun } from 'mobx';
const value = observable.box(0);
const number = observable.box(100);
autorun(() => {
	console.log(value.get());
});
value.set(1);
value.set(2);
number.set(101);
//0,1,2? // autorun ????????
//????????????
//???????map
const map = observable.map({ key: "value"});
//map.set("key", "new value");
//map.get("key")
//????????map
const map = observable({ key: "value"});
// map.key map.key="xiaoming"
//????
const list = observable([1, 2, 4]);
list[2] = 3;
```

(2) action?runInAction?????

```js
import { observable, action, configure, runInAction } from 'mobx';
configure({ enforceActions: 'always' })
//????? ???action,
//???never?????action,
//????always, ?????????? ???????
class Store {
    @observable number = 0;
    @observable name = "kerwin";
    @action add = () => {
        this.number++;
    }//action????????????????????????????
    @action load = async () => {
        const data = await getData();
        runInAction(() => {
            this.name = data.name;
        });
    }// runInAction ??????
}
const newStore = new Store();
newStore.add();
//???????
componentDidMount() {
    autorun(() => {
        console.log(newStore.number);
    })
}
```

4. **mobx-react???**

   ?1?react ????? @observer

    observer ??/???????? React ???????????

    (2) ??????????

   @observable ????React????????????????? React ???????? setState ??????

   ```js
   @observer class Timer extends React.Component {
       @observable secondsPassed = 0
       componentWillMount() {
           setInterval(() => {
               this.secondsPassed++
           }, 1000)
       }//??????????? @action ? runInAction
       //???????????? componentWillReact
       //??????????????????????????
       //???? componentWillReact ????
       componentWillReact() {
           console.log("I will re-render, since the todo has changed!");
       }
       render() {
           return (<span>Seconds passed: {this.secondsPassed} </span>)
       }
   }
   ReactDOM.render(<Timer />, document.body)
   ```

   ?3?**Provider ??**

   ???? React ????(context)??????????? stores? ?????? stores??????? stores?????? inject???? stores ??????? props ???this.props

   ```jsx
   class Store {
       @observable number = 0;
       @action add = () => {
           this.number++;
       }
   }
   export default new Store() //??Store??
   @inject("kerwinstore")
   @observer //??????????
   class Child extends Component {
       render() {
           return <div>
               Child --{this.props.kerwinstore.number}
           </div>
       }
   }
   @inject("kerwinstore")
   class Middle extends Component {
       render() {
           return <div>
               Middle-<button onClick={() => {
                   this.props.kerwinstore.add();
               }}>test</button><Child />
           </div>
       }
   }
   //??provider?store??
   <Provider kerwinstore={store}>
       <Middle />
   </Provider>
   ```

   **5.** **?????**

   ```
   npm i @babel/core @babel/plugin-proposal-decorators @babel/preset-env
   ```

   **??** **.babelrc**

   ```js
   {
       "presets": [
           "@babel/preset-env"
       ],
           "plugins": [
               [
                   "@babel/plugin-proposal-decorators",
                   {
                       "legacy": true
                   }
               ]
           ]
   }
   ```

   **??confifig-overrides.js**

   ```jsx
   const path = require('path')
   const { override, addDecoratorsLegacy } = require('customize-cra')
   function resolve(dir) {
       return path.join(__dirname, dir)
   }
   const customize = () => (config, env) => {
       config.resolve.alias['@'] = resolve('src')
       if (env === 'production') {
           config.externals = {
               'react': 'React',
               'react-dom': 'ReactDOM'
           }
       }
       return config
   };
   module.exports = override(addDecoratorsLegacy(), customize())
   ```

   **????**

   ```
   npm i customize-cra react-app-rewired
   ```

   **??package.json**

   ```
   ...
   "scripts": {
   "start": "react-app-rewired start",
   "build": "react-app-rewired build",
   "test": "react-app-rewired test",
   "eject": "react-app-rewired eject"
   },
   ...
   ```

   ![image-20221023232056439](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023232056439.png)

#### ??. TS

##### **1-typescript**

> ????: http://ts.xcatliu.com/basics/primitive-data-types.html

1. TypeScript ??????????????????????????????

2. ??????????????????????????

3. ????????????????Interfaces?????Generics????Classes??

4. ts??????js

##### **2-??**

```
create-react-app my-app --template typescript
```

![image-20221023232405911](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221023232405911.png)

##### **3-??**

```
1. ?????????declare const $: any;
2. ?? npm i @types/jquery @types?npm??????????*.d.ts??
```

```
npm i --save react-router-dom
npm i --save @types/react-router-dom //??????????????????????
```

##### 4-????

```
// String(???????) vs string (ts????)
var myname:string = "??"
var mybool:boolean = false
var mynumber:number = 100
var mylist:Array<string> = ["111","222","3333"]
var myname2:string | number | boolean = 100
var myname3:string | number = "kerwin"
var mylist2:Array<string| number> = [1,2,"kerwin"]
var mylist3:(string| number)[] = [1,2,"kerwin"]
```

##### 5-??????

**??????**

```js
interface SearchFunc {
    (source: string, subString: string): boolean;
}
//????????????????????????????????????
let mySearch: SearchFunc;
mySearch = function (src: string, sub: string): boolean {
    let result = src.search(sub);
    return result > -1;
}
```

**??**

```js
function Test(list: String[], text?: String, ...args: String[]): void {
    console.log(list, text, args)
}
Test(["1111", "2222"])
//list:["1111","2222"] text: undefined args: []
Test(["0", "1"], "a", "b", "c")
    //list:["0","1"] text: "a" args: ["b","c"]
```

**????**as

```js
function Test(mytext: string | number) {
    console.log((mytext as string).length) //?
    console.log((mytext as any).length) //?
    console.log((mytext as string[]).length) //????????????????
}
```

##### 6-?????

```js
interface MyInter {
    name: String, //????
    readonly country: String,//????
    getName(): void //????
}
class MyObj implements MyInter {
    name = "kerwin"
    country = "China"
    private age = 100 //????? ???????
    getName() {
        //...
    }
    private getAge() {
        //...
    } //????? ???????
}
```

**7-?????**

```js
interface PropInter {
    name: string | number;
    firstName?: string;//????
    lastName?: string;//????
    // [propName: string]: any ????
}
interface StateInter {
    count: number
}
//??? ?????????any
class HelloClass extends React.Component<PropInter, StateInter> {
    state: State = {
        count: 0,
    }; //setState???????
    static defaultProps = { // ?????
        name: "default name"
    firstName: "",
        lastName: "",
    };
}
```

##### 8-???????

```jsx
//???
const App: React.FC = (props) => {
    console.log(props)
    const [name, setname] = useState < string > ("kerwin")
    return <div>
        app
    </div>
}
//??????? -1
interface iprops {
    count: number
}
const Child: React.FC<iprops> = (props) => {
    return <div>
        child-{props.count}
    </div>
}
//??????? -2
const Child = (props: iprops) => {
    return <div>
        child-{props.count}
    </div>
}
```

**useRef**

```jsx
const mytext = useRef < HTMLInputElement > (null)
    < input type = "text" ref = { mytext } />
        useEffect(() => {
            console.log(mytext.current && mytext.current.value)
        }, [])
```

**useContext**

```jsx
interface IContext {
    call: string
}
const GlobalContext = React.createContext < IContext > ({
    call: "" //?????,??????
})
< GlobalContext.Provider value = {{	
    call:"??"
}}>
....
</ >
const { call } = useContext(GlobalContext)
```

**useReducer**

```jsx
interface IPrevState {
    count: number
}
interface IAction {
    type: string,
    payload: any
}
function reducer(prevState: IPrevState, action: IAction) {
    .....
    return prevState
}
const [state, dispatch] = useReducer(reducer, {
    count: 1
})
dispatch({
    type: "Action1",
    payload: []
})
```

##### 9-????

```jsx
//?????
<Child key={index} item={item} index={index} cb={(index) => {
    var newlist = [...list]
    newlist.splice(index, 1)
    setList(newlist)
}} />
//???
interface ItemType {
    item: string,
    index: number, //????
    cb: (param: number) => void //????
}
const Child = (props: ItemType) => {
    let { index, item, cb } = props
    return <div >{item}
        <button onClick={() => cb(index)}>del-{index}</button>
    </div>
}
```

##### 10-??

**?????**

```tsx
// ????????????????
import { RouteComponentProps } from "react-router-dom";
interface IProps { ??????? }
type HomeProps = IProps & RouteComponentProps; //?????????
interface IState { }
class Home extends React.Component<HomeProps, IState> {
    private handleSubmit = async () => {
        //code for API calls
        this.props.history.push("/home");
    };
    public render(): any {
        return <div>Hello</div>;
    }
}
```

**????**

```tsx
interface IParams {
    id: string
}
// RouteComponentProps???????
class Detail extends Component<RouteComponentProps<IParams>>{
    componentDidMount() {
        console.log(this.props.match.params.id)
    } render() {
        return <div>
            detail
        </div>
    }
}
```

##### **11-redux**

```tsx
import { createStore } from 'redux'
interface ActionInter {
    type: String,
    payload: any
}
const reducer = (prevState = {}, action: ActionInter) => {
    return action.payload
}
const store = createStore(reducer,//enhancer)
export default store
```

#### ??. styled-components

????*JavaScript*??*CSS*????????????????????*CSS*????????

??*JavaScript*??*CSS*??????????*CSS*??????????????????????????????????*JSX*???*HTML*?*CSS*?*JS*???????**all in js**???

**??**

```jsx
const StyleApp = styled.div`
background:yellow;
border:1px solid black;
ul{
    li{
    color:red;
    }
}
&:hover{
    background:pink
}//pc ??
`
/*
<StyleApp>
<ul>
<li>1111</li>
<li>22222</li>
</ul>
</StyleApp>
*/
```

**??props**

```tsx
const StyledInput = styled.input`
color: red;
background: yellow;
border: none;
border-radius: 3px;
`
<StyledInput type="text" placeholder="okok"/>
```

**??props?????**

```jsx
const StyledButton = styled.button`
background:${props => props.bg || 'blue'}
`
/*<StyledButton>click</StyledButton>
<StyledButton bg="red">click</StyledButton>*/
```

**???????(????className )**

```jsx
const Child = (props)=><div className={props.className}>child</div>
const StyledChild = styled(Child)`
background:red;
`
<StyledChild/>
```

**????**

```jsx
const MyButton = styled.button`
background:yellow;
`
const BigButton = styled(MyButton)`
height:100px;
width:100px;
`
```

**???**

```jsx
import styled,{keyframes} from 'styled-components'
const rotate360 = keyframes`
from {
transform: rotate(0deg);
}
to {
transform: rotate(360deg);
}
`;
const Rotate = styled.div`
width:100px;
height:100px;
background:yellow;
animation:${rotate360} 1s linear infinite;
```

#### ??.????

#### ??. redux-saga

#### ??. React??

##### **1. Portal**

Portals ???????????????DOM??????DOM??????????

```
ReactDOM.createPortal(child,container);
```

?????child?????react??????????????????????container???DOM??

**1???**

????????????????????DOM????

```jsx
render() {
// React ????div??????????????
    return (
        <div>
       	 {this.props.children}
        </div>
    );
}
```

??????????DOM???????????????portal???

```jsx
render(){
// ??React????div????????????Dom????domNode????????????dom???
    return ReactDOM.createPortal(
   		this.props.children,
    	domNode
    )
}
```

??????????????dom??? overflow:hidden ?? z-inde ??????????????????????????????????????????

**2??protal??????**

????portal????????????????????dom????React?????????dom????????????dom??????

```jsx
import React, { Component } from 'react';
import ReactDOM from 'react-dom';
const getDiv = () => {
    const div = document.createElement('div');
    document.body.appendChild(div);
    return div;
};
const withPortal = (WrappedComponent) => {
    class AddPortal extends Component {
        constructor(props) {
            super(props);
            this.el = getDiv();
        }
        componentWillUnmount() {
            document.body.removeChild(this.el);
        }
        render(props) {
            return ReactDOM.createPortal(<WrappedComponent {...props} />, this.el);
        }
    }
    return AddPortal;
};
class Modal extends Component {
    render() {
        return (
            <div>
                <div>amodal content</div>
                <button type="button">Click</button>
            </div>
        );
    }
}
const PortalModal = withPortal(Modal);
class Page extends Component {
    constructor(props) {
        super(props);
        this.state = { clicks: 0 };
        this.handleClick = this.handleClick.bind(this);
    }
    handleClick() {
        this.setState(state => ({
            clicks: state.clicks + 1
        }));
    }
    render() {
        return (
            <div onClick={this.handleClick}>
                <h3>ppppppppp</h3>
                <h3>num: {this.state.clicks}</h3>
                <PortalModal />
            </div>
        );
    }
}
export default Page;
```

##### **2.Lazy** **?** **Suspense**

**1?React.lazy??**

React.lazy ??????????????????????????

??????????????

 **(1) ????????**

??????????????????????????????????????????????????

????????????????????????????????

**(2) ????**

? Webpack ?????????????????????(Code Splitting)?????????????????????????????????

**(3) ????**

? React.lazy ??????? react-loadable ???????????????webpack???????????????????????????????

?? React.lazy ?????????????? react-loadable ????????

**2?????React.lazy**

????????create-react-app??????

```jsx
//OtherComponent.js ????
import React from 'react'
const OtherComponent = () => {
    return (
        <div>
            ????
        </div>
    )
}
export default OtherComponent
// App.js ????
import React from 'react';
import './App.css';
//??React.lazy??OtherComponent??
const OtherComponent = React.lazy(() => import('./OtherComponent'));
function App() {
    return (
        <div className="App">
            <OtherComponent />
        </div>
    );
}
export default App;
```

?????? React.lazy ?????????????????????React??? lazy ????????????????React???????????????????????????????????Suspense ?

![image-20221024092522299](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221024092522299.png)

 **(1) Suspense**

??? App ???????? OtherComponent ??????????????????????????????????????? Suspense ??????

??? App ?????

```jsx
import React, { Suspense, Component } from 'react';
import './App.css';
//??React.lazy??OtherComponent??
const OtherComponent = React.lazy(() => import('./OtherComponent'));
export default class App extends Component {
    state = {
        visible: false
    }
    render() {
        return (
            <div className="App">
                <button onClick={() => {
                    this.setState({ visible: true })
                }}>??OtherComponent??
                </button>
                <Suspense fallback={<div>Loading...</div>}>
                    {
                        this.state.visible
                            ?
                            <OtherComponent />
                            :
                            null
                    }
                </Suspense>
            </div>
        )
    }
}
```

??????????Loading????????? OtherComponent ?????????? OtherComponent ????????Loading??

![image-20221024092635745](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221024092635745.png)

![image-20221024092657414](https://webpon-img.oss-cn-guangzhou.aliyuncs.com/imgimgimgimage-20221024092657414.png)

??????chrome???? lower-end mobile ??????loading???

??????????????????,???head??? `?????????get?????????loading???? 2.chunk.js`???

?????????? OtherComponent ?????,?????????????webpack????

> ??? Suspense ?????? fallback ??????????? ??????

##### **3. forwordRef**

?????*Ref forwading*???????????????? ??*ref* ??????????????????????????????????????????????*input*????????*focus*????????*ref*?????????*input*????????????????*Ref forward*????????*input*??????????

???forwordRef

```jsx
//???
class Child extends Component {
    componentDidMount() {
        this.props.callback(this.refs.myinput)
    }
    render() {
        return <div>
            <input type="text" ref="myinput" />
        </div>
    }
}
//???
class App extends Component {
    render() {
        return (
            <div>
                <Child callback={(el) => {
                    el.focus()
                }} />
            </div>
        )
    }
}
```

??orwardRef

```jsx
//???
const Child = forwardRef((props, ref) => {
    return <div>
        <input type="text" ref={ref} />
    </div>
})
//???
class App extends Component {
    myref = createRef()
    componentDidMount() {
        this.myref.current.focus()
    }
    render() {
        return (
            <div>
                <Child ref={this.myref} />
            </div>
        )
    }
}
```

##### 4. Functional Component??

???memo?????

??????????????????????????????????????????????????????????????????????????????????????

**??**

?????? *props* ???????????????????????? *React* ????????????????????*React.memo()*?????????????????

**?PureComponent??**

*PureComponent* ????*class* ???*memo* ??*functional* ??

**??**

```jsx
import { memo } from 'react'
const Child = memo(() => {
    return <div>
        <input type="text" />
    </div>
})
??
const Child = () => {
    return <div>
        <input type="text" />
    </div>
})
const MemoChild = memo(Child)
```
